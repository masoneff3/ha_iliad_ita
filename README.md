# Iliad (Italy) Custom Component for Home Assistant

A [Home Assistant](https://www.home-assistant.io/) (HA) custom component for Iiad (Italy).

![Alt text](img/example_dashboard.png?raw=true "Example dashboard")

## Features

- Retrieves the following details from your Iliad account page:
  - Balance (available credit, in EUR)
  - Data usage (amount of data used, in MB/GB)
  - Remaining data

## Installation and configuration

1. Download the `custom_components/iliad_ita` folder in this repository.
2. Copy the `iliad_ita` directory to your Home Assistant `/config/custom_components` directory (create this directory if it does not exist).
   Your configuration should look like this:
	```
	  config
	  └── custom_components
	      └── iliad_ita
	          └── __init__.py
	          └── manifest.json
	          └── sensor.py
	```
3. In your configuration file (e.g., `configuration.yaml`) add the following sensor and replace the default values (`username, password`):
	```
	sensor:
	  - platform: iliad_ita
	    username: "12345678"  # Replace with your User ID
	    password: "password"  # Replace with your password
	```
4. Restart Home Assistant.

> [!TIP]
> To store your password, consider using the `secrets.yaml` file instead. Replace the *password* line with:\
```password: !secret iliad_ita```\
Then, in `secrets.yaml`, add the following:\
```iliad_ita: password # Replace with your password```

> [!NOTE]
> The sensor values will be refreshed every 6 hours (+ a variable interval of up to 15 minutes). If you wish to change the refresh interval, edit the following line in `sensor.py`:\
> ```SCAN_INTERVAL = timedelta(hours=6, minutes=random.randint(0, 15))```

### Does this project use Iliad official APIs?

**Short answer: no**.\
As far as I know, the only "official" APIs are those used by the mobile app, which was released in early 2025 and operates at `api.iliad.it`.\
Technically, it is possible to intercept the traffic generated by the app (e.g., using _mitmproxy_), although the app likely employs certificate pinning. This would allow retrieving the API endpoints and mimicking the requests.\
However, these API calls contain potentially sensitive information, including keys (possibly hardcoded in the app?) required for authentication with Google Firebase. Authenticating with Firebase and obtaining a _clientSecret_ seems to be a prerequisite for the login function (`api.iliad.it/auth/token`).\
Given these factors, while this information can theoretically be extracted by anyone, I am not comfortable sharing it publicly on GitHub.

## Tested on

- Home Assistant (Container) 2025.2.x

## Disclaimer

This software is provided "as-is", without any express or implied warranties. The author is not liable for any damages, legal or regulatory violations resulting from your use of the software.\
You use this software at your own risk.\
The author is under no obligation to provide maintenance, support, updates, or modifications to the software.\
"Iliad" and its logo are the property of Iliad Italia S.p.A. and are used for illustrative purposes only. Their use does not imply any affiliation with or endorsement by Iliad Italia S.p.A.
